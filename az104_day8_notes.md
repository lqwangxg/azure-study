# ✅ AZ-104 学习笔记 - Day 8

## 🎯 学习目标
- 理解 Azure Backup 与 Snapshot 的区别与适用场景
- 掌握 Recovery Vault 的备份策略与恢复机制
- 理解软删除、加密、跨区域复制等数据保护功能

---

## 💾 Azure Backup 概述

| 类型         | 内容                                 |
| ------------ | ------------------------------------ |
| 虚拟机备份   | 完整备份 OS 与数据盘                 |
| 文件备份     | 支持 On-prem / Azure VM              |
| 数据库备份   | SQL / SAP HANA in Azure VM           |
| Blob Backup（预览） | Blob 对象版本恢复（PITR）      |

---

## 🏠 Recovery Vault

- 存储所有备份点
- 设定策略：频率 + 保留期
- 可与 Azure Policy 集成实现自动合规性控制

---

## 📸 快照 vs Azure Backup

| 项目       | Snapshot              | Azure Backup                   |
| ---------- | --------------------- | ------------------------------ |
| 类型       | 临时磁盘级快照        | 托管式备份系统                 |
| 存储位置   | Blob 存储             | Recovery Vault                 |
| 自动化     | ❌                    | ✅ 支持策略调度                |
| 还原方式   | 手动磁盘恢复          | 一键恢复 VM / 文件             |
| 成本       | 按存储计费            | Vault + 数据量计费             |
| 场景       | 临时保存 VM 状态      | 合规 / 长期备份需求            |

---

## 🔐 数据保护功能

- **软删除**：误删备份可恢复（默认保留 14 天）
- **多区域复制（GRS）**：跨地域容灾
- **加密存储**：支持平台密钥和 BYOK

---

## 🔁 还原类型

| 类型     | 示例                       |
| -------- | -------------------------- |
| VM 还原  | 从备份直接重建             |
| 磁盘还原 | 生成 VHD，供挂载           |
| 文件还原 | 选择性恢复目录或文件       |
| 快照还原 | 创建磁盘或替换原盘（需停机）|

---

## ✅ 小测验回顾（满分 🎉）

- **B** - 长期备份应使用 Recovery Vault 策略
- **A,B,D** - Snapshot 快速临时，Backup 策略化管理
- **C** - Vault 可与 Policy 结合使用
- **C** - Soft Delete 可恢复误删备份
- **B** - Snapshot 适合部署前临时备份

---

## 📌 总结

- Snapshot = 临时，Backup = 策略 + 自动化
- Recovery Vault 提供加密、合规、软删除支持
- 多种还原机制灵活满足恢复需求

---

## 🌐 Azure 备份机制 vs AWS 备份机制

| 维度             | Azure Backup                                      | AWS Backup                                      |
| ---------------- | ------------------------------------------------ | ----------------------------------------------- |
| 管理平台         | Recovery Services Vault 统一管理                  | AWS Backup 控制台统一管理                       |
| 支持资源         | VM、文件、数据库、Blob、SAP HANA等                | EC2、EBS、RDS、DynamoDB、EFS、FSx等             |
| 策略与自动化     | 支持备份策略、调度、保留期、自动化                | 支持备份计划、生命周期管理、自动化               |
| 跨区域备份       | 支持 GRS 跨区域复制                              | 支持跨区域备份（Cross-Region Backup）           |
| 加密机制         | 支持平台密钥/自定义密钥（BYOK）                   | 支持 KMS 加密                                   |
| 软删除           | 默认开启软删除，防止误删（14天保留）              | 支持备份保留与删除保护（如 Vault Lock）          |
| 还原粒度         | 支持整机、磁盘、文件级还原                        | 支持整机、卷、数据库、文件级还原                |
| 合规与审计       | 可与 Azure Policy 集成，支持合规性与审计          | 支持 AWS Organizations、标签、合规报告           |

**总结：**
- 两者均提供统一的备份管理平台、策略化调度、加密与合规支持。
- Azure Backup 更强调与 Azure Policy 集成、软删除保护等特性。
- AWS Backup 支持更多 AWS 原生服务，具备跨账户、跨区域备份能力。
- 选择时建议结合实际云平台、合规需求与业务场景进行评估